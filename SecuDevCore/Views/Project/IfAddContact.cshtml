@using SecuDev.Helper
@using SecuDev.Models;
@{
    Layout = "~/Views/Shared/_PopLayout.cshtml";
    List<Contact> contacts = ViewBag.Contact;
}
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.0.0-rc.4/dist/css/tom-select.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.0.0-rc.4/dist/js/tom-select.complete.min.js"></script>
<script>
    $().ready(function () {

        

    })

    function fnAddContact() {

        const ContactName = $("#ContactName").val()
        const ContactGrade = $("#ContactGrade").val()
        const ContactTel = $("#ContactTel").val()
        const ContactEmail = $("#ContactEmail").val()

        if (ContactName == '') {

            alert("입력 값을 다시 확인해주세요.")

            $("#ContactName").focus();

            return
        }

        if (ContactGrade == '') {

            alert("입력 값을 다시 확인해주세요.")

            $("#ContactGrade").focus();

            return
        }

        if (ContactTel == '') {

            alert("입력 값을 다시 확인해주세요.")

            $("#ContactTel").focus();

            return
        }

        pattern = /^\b[A-Z0-9._%-]+@@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i;

        if(!pattern.test(ContactEmail) || ContactEmail == '') {

            alert("입력 값을 다시 확인해주세요.")

            $("#ContactEmail").focus();

            return
        }

        const html = `<li class="list-group-item">
                        <div class="mb-1">
                            <i class="fa-solid fa-star me-1"></i>
                            <span class="">${ContactName}</span>
                        </div>
                        <div class="mb-1">
                            <i class="fa-solid fa-user-tag me-1"></i>
                            <span class="">${ContactGrade}</span>
                        </div>
                        <div class="mb-1">
                            <i class="fa-solid fa-phone me-1"></i>
                            <span class="">${ContactTel}</span>
                        </div>
                        <div class="mb-1">
                            <i class="fa-solid fa-envelope me-1"></i>
                            <span>
                                <email class="email">${ContactEmail}</email>
                            </span>
                        </div>
                    </li>`;

        

        $("#Contact-list").append(html)
        

    }
</script>
<div>

    <h6>업체 관계자 추가</h6>

    <div class="d-flex">
        <div class="flex-grow-1 me-4">
            <small>이름</small>
            <input type="text" id="ContactName" class="form-control form-control-sm" placeholder="업체 관계자 이름 입력" required />
        </div>
        <div class="flex-grow-1 me-4">
            <small>직급</small>
            <input type="text" id="ContactGrade" class="form-control form-control-sm" placeholder="업체 관계자 직급 입력" required />
        </div>
        <div class="flex-grow-1 me-4">
            <small>연락처</small>
            <input type="text" id="ContactTel" class="form-control form-control-sm" placeholder="업체 관계자 연락처 입력" required />
        </div>
        <div class="flex-grow-1">
            <small>이메일</small>
            <input type="text" id="ContactEmail" class="form-control form-control-sm" placeholder="업체 관계자 이메일 입력" required />
        </div>
    </div>

    <br />

    <button type="button" class="w-100 btn btn-border" onclick="javascript:fnAddContact()">추가</button>

    <hr />

    <h6>업체 관계자</h6>
    <ul id="Contact-list" class="list-group">
    @{
        if (contacts.Count > 0)
        {

            foreach (var c in contacts)
            {
                <li class="list-group-item">
                    <div class="mb-1">
                        <i class="fa-solid fa-star me-1"></i>
                        <span class="">@c.ContactName</span>
                    </div>
                    <div class="mb-1">
                        <i class="fa-solid fa-user-tag me-1"></i>
                        <span class="">@c.Grade</span>
                    </div>
                    <div class="mb-1">
                        <i class="fa-solid fa-phone me-1"></i>
                        <span class="">@c.Tel</span>
                    </div>
                    <div class="mb-1">
                        <i class="fa-solid fa-envelope me-1"></i>
                        <span>
                            <email class="email">@c.Email</email>
                        </span>
                    </div>
                </li>
            }
        }
        else
        {
            <li align="center" class="list-group-item">

                <div class="py-5 text-secondary">
                    <h1>
                        <i class="fa-solid fa-users-slash"></i>
                    </h1>

                    <h6>
                        <span>등록된 인원 없음</span>
                    </h6>
                </div>

            </li>
        }
    }
    </ul>
</div>
